# ZephyrGate Configuration Template
# Copy this file to config.yaml and customize for your deployment

app:
  name: "ZephyrGate"
  debug: false  # Set to true for development
  log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# Configure your Meshtastic interfaces
meshtastic:
  interfaces:
    # Serial interface example
    - type: "serial"
      port: "/dev/ttyUSB0"  # Adjust for your system
      baud_rate: 921600
      name: "Primary Radio"
    
    # TCP interface example (for Meshtastic devices with WiFi)
    # - type: "tcp"
    #   host: "192.168.1.100"
    #   port: 4403
    #   name: "WiFi Radio"
    
    # Bluetooth LE interface example
    # - type: "ble"
    #   address: "AA:BB:CC:DD:EE:FF"
    #   name: "BLE Radio"

# Database location
database:
  path: "data/zephyrgate.db"

# Enable/disable services as needed
services:
  bbs:
    enabled: true
    # JS8Call integration (optional)
    js8call:
      enabled: false
      host: "localhost"
      port: 2442
      groups: ["@ALLCALL", "@EMERGENCY"]
  
  emergency:
    enabled: true
    # Add node IDs of emergency responders
    responders: []  # Example: ["!12345678", "!87654321"]
    escalation_timeout: 1800  # 30 minutes
  
  bot:
    enabled: true
    auto_response: true
    new_node_greeting: true
    
    # AI integration (requires local AI service)
    ai:
      enabled: false
      service: "ollama"
      model: "llama2"
      api_url: "http://localhost:11434"
  
  weather_service:
    enabled: true
    update_interval: 3600
    
    # Default location (used when user hasn't set their location)
    # You can specify location in three ways:
    # 1. By zipcode (easiest for US locations):
    #    zipcode: "10001"
    #    country: "US"  # optional, defaults to US
    # 2. By coordinates:
    #    latitude: 40.7128
    #    longitude: -74.0060
    # 3. By location name:
    #    location_name: "New York City"
    default_location:
      zipcode: "10001"       # New York City zipcode
      country: "US"
      name: "New York City"  # Optional: override the geocoded name
      # latitude: 40.7128    # Alternative: use coordinates instead
      # longitude: -74.0060
    
    sources:
      noaa:
        enabled: true
      open_meteo:
        enabled: true
    
    # Enable alert sources you want
    alerts:
      fema_ipaws: true
      noaa_weather: true
      usgs_earthquake: true
  
  # Email gateway (requires email server configuration)
  email:
    enabled: false
    smtp:
      host: "smtp.gmail.com"
      port: 587
      username: "your-email@gmail.com"
      password: "your-app-password"
    imap:
      host: "imap.gmail.com"
      port: 993
      username: "your-email@gmail.com"
      password: "your-app-password"
    authorized_senders:
      - "trusted@example.com"
  
  web:
    enabled: true
    port: 8080
    auth:
      default_username: "admin"
      default_password: "CHANGE_THIS_PASSWORD"  # IMPORTANT: Change this!

# Logging configuration
logging:
  level: "INFO"
  file: "logs/zephyrgate.log"
  console: true

# Security settings
security:
  # Add trusted node IDs
  trusted_nodes: []
  # Add admin node IDs
  admin_nodes: []  # Example: ["!12345678"]
  
  rate_limiting:
    enabled: true
    max_requests_per_minute: 60

# Scheduling (optional automated tasks)
scheduling:
  enabled: true
  tasks:
    # Broadcast weather every 6 hours
    weather_broadcast:
      enabled: false
      schedule: "0 */6 * * *"
      channel: 0
    
    # Sync BBS every 15 minutes
    bbs_sync:
      enabled: false
      schedule: "*/15 * * * *"

# Plugin System Configuration
# Third-party plugins extend ZephyrGate functionality
plugins:
  # Plugin discovery paths
  # Plugins are searched in these directories in order
  paths:
    - "plugins"  # Your custom plugins
    - "examples/plugins"  # Example plugins (for reference)
    # - "/opt/zephyrgate/plugins"  # System-wide plugins
    # - "~/.zephyrgate/plugins"  # User-specific plugins
  
  # Automatic discovery and loading
  auto_discover: true  # Scan paths for plugins automatically
  auto_load: true  # Load discovered plugins on startup
  
  # Plugin control
  # Leave enabled_plugins empty to enable all discovered plugins
  # Or specify a list of plugin names to enable only those
  enabled_plugins: []
    # Example:
    # - "weather_alert"
    # - "custom_menu"
    # - "data_logger"
  
  # Explicitly disable specific plugins
  disabled_plugins: []
    # Example:
    # - "experimental_plugin"
  
  # Health monitoring settings
  health_check_interval: 60  # Check plugin health every 60 seconds
  failure_threshold: 5  # Disable plugin after 5 consecutive failures
  restart_backoff_base: 2  # Start with 2 second restart delay
  restart_backoff_max: 300  # Maximum 5 minute restart delay
  
  # Resource limits (per plugin)
  max_http_requests_per_minute: 100  # HTTP rate limit
  max_storage_size_mb: 100  # Database storage limit
  task_timeout: 300  # Maximum task execution time (5 minutes)